<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self';
              script-src 'self' 'unsafe-inline' https://www.gstatic.com https://apis.google.com https://pagead2.googlesyndication.com;
              style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
              font-src 'self' https://fonts.gstatic.com;
              img-src 'self' data: https: blob:;
              connect-src 'self' https://*.firebaseio.com https://*.googleapis.com https://*.firebaseapp.com https://www.gstatic.com wss://*.firebaseio.com;
              frame-src 'self' https://accounts.google.com https://content.googleapis.com https://*.firebaseapp.com;"
    />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta
      http-equiv="Referrer-Policy"
      content="strict-origin-when-cross-origin"
    />

    <meta
      name="description"
      content="æ—¥æœ¬è€å¹´æ­¯ç§‘åŒ»å­¦ä¼šåŸºæº–ã«åŸºã¥ãå£è…”æ©Ÿèƒ½ä½ä¸‹ç—‡ã®è¨ºæ–­ãƒ»ç®¡ç†ãƒ„ãƒ¼ãƒ«ã€‚æ­¯ç§‘åŒ»å¸«ãƒ»æ­¯ç§‘è¡›ç”Ÿå£«å‘ã‘ã®è¨ºæ–­è£œåŠ©ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚"
    />
    <meta
      name="keywords"
      content="å£è…”æ©Ÿèƒ½,æ­¯ç§‘,è¨ºæ–­,ç®¡ç†,åŒ»ç™‚å¾“äº‹è€…,å£è…”æ©Ÿèƒ½ä½ä¸‹ç—‡,æ—¥æœ¬è€å¹´æ­¯ç§‘åŒ»å­¦ä¼š"
    />
    <meta name="author" content="å£è…”æ©Ÿèƒ½ä½ä¸‹ç—‡è¨ºæ–­ãƒ»ç®¡ç†ã‚¢ãƒ—ãƒª" />

    <title>
      å£è…”æ©Ÿèƒ½ä½ä¸‹ç—‡ è¨ºæ–­ãƒ»ç®¡ç†ã‚¢ãƒ—ãƒª - æ­¯ç§‘åŒ»ç™‚å¾“äº‹è€…å‘ã‘è¨ºæ–­æ”¯æ´ãƒ„ãƒ¼ãƒ«
    </title>
    <link rel="stylesheet" href="styles.css" />

    <style>
      .landing-container {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-align: center;
        padding: 20px;
      }

      .landing-card {
        background: white;
        color: #333;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        max-width: 600px;
        width: 100%;
        margin: 20px;
      }

      .landing-title {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 20px;
        color: #2c3e50;
      }

      .landing-subtitle {
        font-size: 1.2rem;
        color: #7f8c8d;
        margin-bottom: 30px;
      }

      .features-list {
        text-align: left;
        margin: 30px 0;
      }

      .feature-item {
        display: flex;
        align-items: center;
        margin: 15px 0;
        font-size: 1.1rem;
      }

      .feature-icon {
        width: 24px;
        height: 24px;
        margin-right: 15px;
        background: #27ae60;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      .auth-section {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 12px;
        margin: 20px 0;
      }

      .auth-title {
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: #2c3e50;
      }

      .google-login-btn {
        background: #4285f4;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 1.1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        width: 100%;
        transition: background-color 0.3s;
      }

      .google-login-btn:hover {
        background: #3367d6;
      }

      .google-login-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      .loading-spinner {
        width: 20px;
        height: 20px;
        border: 2px solid #ffffff;
        border-top: 2px solid transparent;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .offline-notice {
        background: #f39c12;
        color: white;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        font-size: 0.9rem;
      }

      .demo-link {
        display: inline-block;
        margin-top: 20px;
        color: #3498db;
        text-decoration: none;
        font-size: 1rem;
      }

      .demo-link:hover {
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        .landing-title {
          font-size: 2rem;
        }

        .landing-card {
          padding: 30px 20px;
          margin: 10px;
        }
      }
    </style>
  </head>

  <body>
    <div class="landing-container">
      <div class="landing-card">
        <h1 class="landing-title">å£è…”æ©Ÿèƒ½ä½ä¸‹ç—‡<br />è¨ºæ–­ãƒ»ç®¡ç†ã‚¢ãƒ—ãƒª</h1>
        <p class="landing-subtitle">
          æ—¥æœ¬è€å¹´æ­¯ç§‘åŒ»å­¦ä¼šã®åŸºæº–ã«åŸºã¥ãè¨ºæ–­ãƒ»ç®¡ç†ãƒ„ãƒ¼ãƒ«
        </p>

        <div class="features-list">
          <div class="feature-item">
            <div class="feature-icon">âœ“</div>
            <span>å£è…”æ©Ÿèƒ½ç²¾å¯†æ¤œæŸ»ã®æ”¯æ´</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon">âœ“</div>
            <span>è¨ºæ–­çµæœã®è‡ªå‹•åˆ¤å®š</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon">âœ“</div>
            <span>ç®¡ç†è¨ˆç”»æ›¸ãƒ»è¨˜éŒ²ç°¿ã®ä½œæˆ</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon">âœ“</div>
            <span>æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã®å®‰å…¨ãªç®¡ç†</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon">âœ“</div>
            <span>ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸã§ã©ã“ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹</span>
          </div>
        </div>

        <div class="auth-section">
          <h3 class="auth-title">ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦å§‹ã‚ã‚‹</h3>
          <p style="margin-bottom: 20px; color: #666; font-size: 0.9rem">
            æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚’å®‰å…¨ã«ä¿å­˜ã—ã€è¤‡æ•°ã®ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰åˆ©ç”¨ã§ãã¾ã™
          </p>

          <button
            id="google-login-btn"
            class="google-login-btn"
            onclick="handleGoogleLogin()"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 18 18"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.64 9.205c0-.639-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"
                fill="#4285F4"
              />
              <path
                d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 009 18z"
                fill="#34A853"
              />
              <path
                d="M3.964 10.71A5.41 5.41 0 013.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 000 9c0 1.452.348 2.827.957 4.042l3.007-2.332z"
                fill="#FBBC05"
              />
              <path
                d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 00.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"
                fill="#EA4335"
              />
            </svg>
            <span id="login-text">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</span>
          </button>
        </div>

        <!-- ã‚ˆãã‚ã‚‹è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="faq-section" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
          <h3 style="font-size: 1.2rem; color: #2c3e50; margin-bottom: 20px; text-align: center;">â“ ã‚ˆãã‚ã‚‹è³ªå•</h3>

          <!-- FAQ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯JavaScriptã§å‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ -->
          <div id="faq-content" style="text-align: center; color: #666; padding: 20px;">
            ğŸ“„ ã‚ˆãã‚ã‚‹è³ªå•ã‚’èª­ã¿è¾¼ã¿ä¸­...
          </div>

          <div style="margin-top: 15px; text-align: center;">
            <a href="faq.html" style="color: #3498db; text-decoration: none; font-size: 0.9rem;">ã™ã¹ã¦ã®è³ªå•ã‚’è¦‹ã‚‹</a> |
            <a href="contact.html" style="color: #3498db; text-decoration: none; font-size: 0.9rem;">ãŠå•ã„åˆã‚ã›</a>
          </div>

        <div
          style="
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
          "
        >
        
          <p style="font-size: 0.8rem; color: #999">
            â€»
            æœ¬ã‚¢ãƒ—ãƒªã¯è¨ºæ–­è£œåŠ©ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æœ€çµ‚çš„ãªè¨ºæ–­ã¯åŒ»ç™‚å¾“äº‹è€…ãŒè¡Œã£ã¦ãã ã•ã„ã€‚
          </p>
        </div>
      </div>
    </div>

    <!-- Firebase SDKã‚’CDNã‹ã‚‰èª­ã¿è¾¼ã¿ -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-functions.js"></script>

    <!-- Firebaseè¨­å®š -->
    <script src="firebase-config.js"></script>

    <script>
      let isLoggingIn = false;

      // faq.htmlã‹ã‚‰ã‚ˆãã‚ã‚‹è³ªå•ã‚’å‹•çš„ã«èª­ã¿è¾¼ã‚€é–¢æ•°
      async function loadFAQFromExternal() {
        try {
          const response = await fetch('faq.html');
          const text = await response.text();

          // HTMLãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆ
          const parser = new DOMParser();
          const doc = parser.parseFromString(text, 'text/html');

          // ã‚ˆãã‚ã‚‹è³ªå•ã®detailsè¦ç´ ã‚’å–å¾—ï¼ˆæœ€åˆã®5å€‹ã®ã¿è¡¨ç¤ºï¼‰
          const faqDetails = Array.from(doc.querySelectorAll('details')).slice(0, 5);
          const faqContentDiv = document.getElementById('faq-content');

          if (faqDetails.length > 0 && faqContentDiv) {
            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¯ãƒªã‚¢
            faqContentDiv.innerHTML = '';
            faqContentDiv.style.textAlign = 'left';

            // faq.htmlã‹ã‚‰detailsè¦ç´ ã‚’ã‚³ãƒ”ãƒ¼
            faqDetails.forEach(detail => {
              if (detail.querySelector('summary')) {
                const clonedDetail = detail.cloneNode(true);
                // index.htmlç”¨ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è»½ãèª¿æ•´
                clonedDetail.style.cssText = 'margin: 8px 0; border: 1px solid #ddd; border-radius: 4px; padding: 8px;';
                const summary = clonedDetail.querySelector('summary');
                if (summary) {
                  summary.style.cssText = 'cursor: pointer; font-weight: bold; padding: 4px 0; outline: none; font-size: 0.95rem;';
                }
                const content = clonedDetail.querySelector('p');
                if (content) {
                  content.style.cssText = 'margin: 0; font-size: 0.85rem; color: #555; line-height: 1.4;';
                  content.parentElement.style.cssText = 'border-top: 1px solid #ddd; margin-top: 8px; padding-top: 8px;';
                }

                faqContentDiv.appendChild(clonedDetail);
              }
            });

            console.log('ã‚ˆãã‚ã‚‹è³ªå•ã‚’å‹•çš„ã«æ›´æ–°ã—ã¾ã—ãŸ');
          }
        } catch (error) {
          console.log('ã‚ˆãã‚ã‚‹è³ªå•ã®å‹•çš„èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
          // å¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          const faqContentDiv = document.getElementById('faq-content');
          if (faqContentDiv) {
            faqContentDiv.innerHTML = '<p style="color: #999; font-size: 0.9rem;">ã‚ˆãã‚ã‚‹è³ªå•ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<a href="faq.html">ã“ã¡ã‚‰</a>ã‹ã‚‰ã”è¦§ãã ã•ã„ã€‚</p>';
          }
        }
      }


      // FirebaseåˆæœŸåŒ–å¾…ã¡
      document.addEventListener("DOMContentLoaded", async function () {
        try {
          // ã‚ˆãã‚ã‚‹è³ªå•ã‚’å‹•çš„ã«èª­ã¿è¾¼ã¿
          await loadFAQFromExternal();

          // FirebaseåˆæœŸåŒ–
          if (typeof firebaseManager !== "undefined") {
            await firebaseManager.initialize();
            console.log("FirebaseåˆæœŸåŒ–å®Œäº†");

            // èªè¨¼çŠ¶æ…‹ã®ç›£è¦–
            if (firebaseManager.auth) {
              firebaseManager.auth.onAuthStateChanged((user) => {
                if (user) {
                  console.log(
                    "ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œå‡ºã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ"
                  );
                  window.location.href = "dashboard.html";
                } else {
                  console.log("æœªãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼");
                  showOfflineOption();
                }
              });
            }
          } else {
            console.error("firebaseManager ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
            showOfflineOption();
          }
        } catch (error) {
          console.error("åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:", error);
          showOfflineOption();
        }
      });

      // Googleãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
      async function handleGoogleLogin() {
        if (isLoggingIn) return;

        try {
          isLoggingIn = true;
          updateLoginButton(true);

          if (!firebaseManager || !firebaseManager.isAvailable()) {
            throw new Error("Firebase ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
          }

          await firebaseManager.signInWithGoogle();
          // ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸæ™‚ã¯ onAuthStateChanged ã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
        } catch (error) {
          console.error("ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼:", error);
          isLoggingIn = false;
          updateLoginButton(false);

          // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
          showErrorMessage(error.message || "ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ");
        }
      }

      // ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
      function updateLoginButton(loading) {
        const btn = document.getElementById("google-login-btn");
        const text = document.getElementById("login-text");

        if (loading) {
          btn.disabled = true;
          text.innerHTML = '<div class="loading-spinner"></div> ãƒ­ã‚°ã‚¤ãƒ³ä¸­...';
        } else {
          btn.disabled = false;
          text.textContent = "Googleã§ãƒ­ã‚°ã‚¤ãƒ³";
        }
      }

      // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã®é¸æŠè‚¢è¡¨ç¤º
      function showOfflineOption() {
        const offlineNotice = document.getElementById("offline-notice");
        const demoLink = document.getElementById("demo-link");

        if (offlineNotice) offlineNotice.style.display = "block";
        if (demoLink) demoLink.style.display = "inline-block";
      }

      // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
      function showErrorMessage(message) {
        // æ—¢å­˜ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
        const existingError = document.getElementById("error-message");
        if (existingError) existingError.remove();

        const errorDiv = document.createElement("div");
        errorDiv.id = "error-message";
        errorDiv.style.cssText = `
        background: #e74c3c;
        color: white;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        font-size: 0.9rem;
        text-align: center;
      `;
        errorDiv.textContent = message;

        const authSection = document.querySelector(".auth-section");
        authSection.appendChild(errorDiv);

        // 5ç§’å¾Œã«è‡ªå‹•å‰Šé™¤
        setTimeout(() => {
          if (errorDiv.parentElement) {
            errorDiv.remove();
          }
        }, 5000);
      }
    </script>
  </body>
</html>
